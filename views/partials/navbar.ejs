<!-- Load Bootstrap 5 and Font Awesome CSS (ideally in your boilerplate head or layout once) -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
/>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>
<link rel="stylesheet" href="/css/navbar.css" />

<nav
  class="navbar navbar-expand-lg navbar-light shadow-sm py-3 animate-navbar"
  aria-label="Main navigation"
>
  <div class="container-fluid px-4">
    <a
      class="navbar-brand fw-bold text-gradient"
      href="/caredata"
      aria-label="CareData Home"
      >CareData</a
    >
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
      aria-controls="navbarNav"
      aria-expanded="false"
      aria-label="Toggle navigation menu"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div
      class="collapse navbar-collapse justify-content-end"
      id="navbarNav"
      role="region"
      aria-live="polite"
      aria-label="Primary navigation links"
    >
      <ul class="navbar-nav align-items-center gap-lg-3">
        <li class="nav-item">
          <a
            class="nav-link nav-link-hover px-3"
            href="/caredata"
            role="link"
            aria-current="<%= (typeof page !== 'undefined' && page === 'home') ? 'page' : undefined %>"
            >Home</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link nav-link-hover px-3"
            href="/caredata/doctors"
            role="link"
            aria-current="<%= (typeof page !== 'undefined' && page === 'doctors') ? 'page' : undefined %>"
            >Find Doctors</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link nav-link-hover px-3"
            href="/video"
            role="link"
            aria-current="<%= (typeof page !== 'undefined' && page === 'video') ? 'page' : undefined %>"
            >Video Consult</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-hover px-3" href="/blogs" role="link">Blog</a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-hover px-3" href="/labtests" role="link"
            >Lab Tests</a
          >
        </li>

        <% if(typeof user === 'undefined' || !user){ %>
        <li class="nav-item d-none d-lg-block">
          <a
            class="btn nav-btn nav-btn-fill px-4"
            href="/register"
            role="button"
            >Sign Up</a
          >
        </li>
        <li class="nav-item d-none d-lg-block">
          <a
            class="btn nav-btn nav-btn-outline px-4"
            href="/login"
            role="button"
            >Sign In</a
          >
        </li>
        <li class="nav-item d-lg-none">
          <a class="nav-link" href="/register" role="link">Sign Up</a>
        </li>
        <li class="nav-item d-lg-none">
          <a class="nav-link" href="/login" role="link">Sign In</a>
        </li>
        <% } else { %>
        <li class="nav-item dropdown">
          <a
            href="#"
            class="nav-link dropdown-toggle d-flex align-items-center"
            id="navbarProfile"
            role="button"
            data-bs-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            aria-label="User menu"
          >
            <% if(user.image && user.image.path){ %>
            <img
              src="<%= user.image.path %>"
              alt="User avatar"
              class="avatar shadow-sm border"
              loading="lazy"
              decoding="async"
              width="40"
              height="40"
            />
            <% } else { %>
            <span
              class="avatar avatar-fallback bg-primary text-white shadow-sm border d-flex align-items-center justify-content-center"
              aria-label="User avatar placeholder"
            >
              <i class="fa-solid fa-user"></i>
            </span>
            <% } %>
          </a>
          <ul
            class="dropdown-menu dropdown-menu-end mt-2 animate-dropdown"
            aria-labelledby="navbarProfile"
            role="menu"
          >
            <li>
              <a
                class="dropdown-item"
                href="/caredata/<%= user.entryType==='patient' ? 'users':'doctors' %>/<%= user._id %>"
                role="menuitem"
                tabindex="0"
                ><i class="fa-regular fa-user me-2"></i> Profile</a
              >
            </li>
            <li>
              <a
                class="dropdown-item"
                href="/caredata/doctors"
                role="menuitem"
                tabindex="0"
                ><i class="fa-solid fa-user-doctor me-2"></i> Find Doctors</a
              >
            </li>
            <li><hr class="dropdown-divider" /></li>
            <li>
              <form action="/logout" method="post" class="m-0">
                <button
                  class="dropdown-item text-danger"
                  type="submit"
                  role="menuitem"
                  tabindex="0"
                >
                  <i class="fa-solid fa-arrow-right-from-bracket me-2"></i> Log
                  out
                </button>
              </form>
            </li>
          </ul>
        </li>
        <% } %>
      </ul>
    </div>
  </div>
</nav>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
